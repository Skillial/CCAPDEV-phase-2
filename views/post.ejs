
<html>
    <head>
		<meta charset="UTF-8">
		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
		<script src="/javascript/react.js"></script>
        <script src="/javascript/postView-jean.js"></script>
		<title>
			<%= post.title %>
		</title>
        <link rel="icon" href="../images/icon.png" sizes="32x32" type="image/png">
        <link rel="stylesheet" type="text/css" href="/css/styles.css">
	</head>
	<body>
        <script src="/javascript/navbar.js" type="text/javascript"></script>
		<script>
			createNavbar('' ,<%= isLoggedIn %>);
		</script>
		<div class="border">
			<div class="content_list">
                
			</div>
            <script>
                // console.log('<%= user.username %>');
                <% if (!post.isDeleted) { %>
                  let postID = '<%= post._id %>',
                  
                      pauthor = '<%= post.author %>',
                      ptitle = '<%= post.title %>',
                      pdesc = '<%= post.content %>',
                      ppostedDate = new Date('<%= post.createDate %>').toLocaleString();
                      // console.log(postID)
                  let peditedDate = '<%= post.editDate %>';
                  if (peditedDate) {
                    peditedDate = new Date(peditedDate).toLocaleString();
                  } else {
                    peditedDate = '- Not Edited'; //not edited
                  }
                  prating = '<%= post.rating %>', 
                  pmedia = '<%= post.media %>'; //remove?
                
                  let ppfp = '<%= author.pfp_link %>';
                  let preactValue = '<%= reactValue %>';
                  let isCurrUserTheAuthor = '<%=isCurrUserTheAuthor%>';
                  console.log(isCurrUserTheAuthor);
                
                  $('.content_list').append(posthtml(postID, pauthor, ptitle, ppfp, pdesc, ppostedDate, peditedDate, prating, pmedia, preactValue, isCurrUserTheAuthor ));
                <% } else { %>
                  // Display a message when the post is deleted
                  $('.content_list').append('<div>The original post was deleted, but you can still view the comments.</div>');
                <% } %>
              </script>
              
              <% comments.forEach(comment => { %>
                 <script>
                  $('.border').append(postreply('<%= comment.userID.username %>','<%= comment.userID.ppfp %>','<%= comment.content %>', '<%= comment.rating %>', '<%= comment._id %>','<%= user.username %>'));
                </script>
                  <!-- <p>1<%= comment.userID.username %>:</p> 
                  <p>2<%= comment.content %></p> 
                  <p>3<%= comment.userID.ppfp %></p> 
                  <p>4<%= comment.rating %></p> 
                  <p>5<%= comment._id %></p> -->
                      <% comment.children.forEach(child => { %>
                        <script>
                          $('.border').append(postreply('<%= child.userID.username %>','<%= child.userID.ppfp %>','<%= child.content %>', '<%= child.rating %>', '<%= child._id %>','<%= user.username %>'));
                        </script>
                      <% }); %>
              <% }); %>
              <!-- <script>
                pauthor = 'Ecola',    
                ppfp = '../sample users/Ecola.jpg',
                pdesc = 'Look up some videos on YouTube on technique for how to hold the knife, where to rest it on your knuckle etc... and stick to it no matter '+
                        'how slow you are. With proper technique the risk of injury is extremely low. Let speed come naturally - donâ€™t try to force it. Also make '+
                        'sure your knives are sharp',

                pcount = '1.5k';
                let pid='1';
                $('.border').append(postreply(pauthor,ppfp,pdesc,pcount,pid) );
            </script> -->


                <!-- <div class="comments-section" id="commentsContainer"> -->
                    <!-- Comments will be dynamically added here -->
                <!-- </div> -->

                <!-- <script>
                  // Get the comments data from the server-side and convert it to a JavaScript object
                  const commentsData = <%= JSON.stringify(comments) %>;
                  console.log("here");
                
                  // Function to append comments to the comments container
                  function appendComments(commentsData) {
                    const commentsContainer = $('.border'); // Select the container for comments
                
                    commentsData.forEach((comment) => {
                      const commentElement = postreply(comment.author, comment.ppfp, comment.content, comment.pcount, comment._id);
                      console.log(comment.author);
                      console.log(comment.ppfp);
                      console.log(comment.content);
                      console.log(comment.pcount);
                      console.log(comment._id);
                      commentsContainer.append(commentElement);
                    });
                  }
                
                  // Append the comments after the page loads
                  $(document).ready(function() {
                    appendComments(commentsData);
                  });
                </script> -->



  
            
		</div>
	</body>
</html>